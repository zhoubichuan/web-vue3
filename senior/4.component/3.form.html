<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/favicon.ico"><title>二.数据输入（表单） | Vue3.x学习笔记</title><meta name="description" content="风浪没平息 我宣告奔跑的意义">
    <link rel="modulepreload" href="/web-vue3/assets/app.8390b8a1.js"><link rel="modulepreload" href="/web-vue3/assets/3.form.html.1379da1c.js"><link rel="modulepreload" href="/web-vue3/assets/3.form.html.aeff8066.js"><link rel="prefetch" href="/web-vue3/assets/index.html.fb596a5a.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.9f74e5a5.js"><link rel="prefetch" href="/web-vue3/assets/1.utils.html.4394abab.js"><link rel="prefetch" href="/web-vue3/assets/10.skill.html.89167d87.js"><link rel="prefetch" href="/web-vue3/assets/11.mock.html.2d7b2adf.js"><link rel="prefetch" href="/web-vue3/assets/12.optimization.html.977ffc3a.js"><link rel="prefetch" href="/web-vue3/assets/13.deploy.html.17e622f5.js"><link rel="prefetch" href="/web-vue3/assets/2.project.html.4f4427d3.js"><link rel="prefetch" href="/web-vue3/assets/3.vuecli.html.90a51794.js"><link rel="prefetch" href="/web-vue3/assets/4.env.html.1f19459a.js"><link rel="prefetch" href="/web-vue3/assets/5.ui.html.56c3c2c1.js"><link rel="prefetch" href="/web-vue3/assets/6.layout.html.0338432b.js"><link rel="prefetch" href="/web-vue3/assets/7.single.html.52142209.js"><link rel="prefetch" href="/web-vue3/assets/8.page.html.135f873a.js"><link rel="prefetch" href="/web-vue3/assets/9.module.html.de30fd5a.js"><link rel="prefetch" href="/web-vue3/assets/1.config.html.309067ee.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.1a419595.js"><link rel="prefetch" href="/web-vue3/assets/10.server.html.f0a98a35.js"><link rel="prefetch" href="/web-vue3/assets/11.pwa.html.6e186dfc.js"><link rel="prefetch" href="/web-vue3/assets/12.upload.html.c1028a12.js"><link rel="prefetch" href="/web-vue3/assets/13.video.html.d42d96eb.js"><link rel="prefetch" href="/web-vue3/assets/2.skill.html.189cbc4a.js"><link rel="prefetch" href="/web-vue3/assets/3.login.html.7799b507.js"><link rel="prefetch" href="/web-vue3/assets/4.projectMonitor.html.0b5763a5.js"><link rel="prefetch" href="/web-vue3/assets/5.test.html.7b7496d6.js"><link rel="prefetch" href="/web-vue3/assets/6.configurePrem.html.341b71e8.js"><link rel="prefetch" href="/web-vue3/assets/7.internationalization.html.c06c557d.js"><link rel="prefetch" href="/web-vue3/assets/8.errorCollection.html.62d1892e.js"><link rel="prefetch" href="/web-vue3/assets/9.optimize.html.57df0570.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.b8c623e0.js"><link rel="prefetch" href="/web-vue3/assets/1.vue-cli3.html.331b13dc.js"><link rel="prefetch" href="/web-vue3/assets/2.life.html.4cfe0cea.js"><link rel="prefetch" href="/web-vue3/assets/2.vue.html.57b2dfb3.js"><link rel="prefetch" href="/web-vue3/assets/2.vue1.html.981058a8.js"><link rel="prefetch" href="/web-vue3/assets/3.vue-router.html.6c501d80.js"><link rel="prefetch" href="/web-vue3/assets/4.vuex.html.b603f145.js"><link rel="prefetch" href="/web-vue3/assets/5.ui.html.818d3477.js"><link rel="prefetch" href="/web-vue3/assets/6.vueuse.html.91bedf3b.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.d20ee5b9.js"><link rel="prefetch" href="/web-vue3/assets/1.singlespa.html.4cda3316.js"><link rel="prefetch" href="/web-vue3/assets/1.singlespa2.html.c3017287.js"><link rel="prefetch" href="/web-vue3/assets/2.qiankun.html.df43f06e.js"><link rel="prefetch" href="/web-vue3/assets/2.qiankun2.html.26f61d43.js"><link rel="prefetch" href="/web-vue3/assets/3.share.html.f95c5a4a.js"><link rel="prefetch" href="/web-vue3/assets/4.dev.html.1d08b485.js"><link rel="prefetch" href="/web-vue3/assets/1.env.html.b826fd43.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.233ba2c8.js"><link rel="prefetch" href="/web-vue3/assets/10.infer.html.7be10a98.js"><link rel="prefetch" href="/web-vue3/assets/11.overlapping.html.1eddac7c.js"><link rel="prefetch" href="/web-vue3/assets/12.condition.html.636a42a9.js"><link rel="prefetch" href="/web-vue3/assets/13.builtin.html.f6f12be6.js"><link rel="prefetch" href="/web-vue3/assets/14.package.html.25ba3582.js"><link rel="prefetch" href="/web-vue3/assets/15.custom.html.261522de.js"><link rel="prefetch" href="/web-vue3/assets/16.unknown.html.688c9a5e.js"><link rel="prefetch" href="/web-vue3/assets/17.module.html.cddc14d6.js"><link rel="prefetch" href="/web-vue3/assets/18.statement.html.510e3b18.js"><link rel="prefetch" href="/web-vue3/assets/19.extend.html.1828cf2f.js"><link rel="prefetch" href="/web-vue3/assets/2.base.html.c1d2473c.js"><link rel="prefetch" href="/web-vue3/assets/3.deduction.html.c2fc45e5.js"><link rel="prefetch" href="/web-vue3/assets/4.type.html.c92aa05d.js"><link rel="prefetch" href="/web-vue3/assets/5.class.html.221656c8.js"><link rel="prefetch" href="/web-vue3/assets/6.interface.html.6d05d6df.js"><link rel="prefetch" href="/web-vue3/assets/7.generic.html.f2746095.js"><link rel="prefetch" href="/web-vue3/assets/8.compatible.html.54bd7735.js"><link rel="prefetch" href="/web-vue3/assets/9.protect.html.28d633ac.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.4ab72945.js"><link rel="prefetch" href="/web-vue3/assets/1.local.html.f0ff25b0.js"><link rel="prefetch" href="/web-vue3/assets/2.gitlab.html.61eda6b1.js"><link rel="prefetch" href="/web-vue3/assets/3.genkins.html.68aabcce.js"><link rel="prefetch" href="/web-vue3/assets/4.centos.html.72883b9d.js"><link rel="prefetch" href="/web-vue3/assets/5.nginx.html.0c5cb623.js"><link rel="prefetch" href="/web-vue3/assets/1.button.html.2c3dfea9.js"><link rel="prefetch" href="/web-vue3/assets/1.env.html.d8476ce8.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.d8b65384.js"><link rel="prefetch" href="/web-vue3/assets/1.recursion.html.78834090.js"><link rel="prefetch" href="/web-vue3/assets/10.tree.html.061b718a.js"><link rel="prefetch" href="/web-vue3/assets/12.table.html.e7a6e04f.js"><link rel="prefetch" href="/web-vue3/assets/13.publish.html.0629d0a7.js"><link rel="prefetch" href="/web-vue3/assets/2.dropdown.html.e14edfa6.js"><link rel="prefetch" href="/web-vue3/assets/3.dialog.html.559a5048.js"><link rel="prefetch" href="/web-vue3/assets/4.input.html.590b9d75.js"><link rel="prefetch" href="/web-vue3/assets/4.render.html.0a4fbf3a.js"><link rel="prefetch" href="/web-vue3/assets/5.checkBox.html.f572ba2f.js"><link rel="prefetch" href="/web-vue3/assets/6.cascader.html.f3050418.js"><link rel="prefetch" href="/web-vue3/assets/7.date.html.3c71400d.js"><link rel="prefetch" href="/web-vue3/assets/8.dispaly.html.f4365d57.js"><link rel="prefetch" href="/web-vue3/assets/9.alert.html.34e816ae.js"><link rel="prefetch" href="/web-vue3/assets/9.dynamics.html.ca5c48f9.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.639403d4.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.9c4f1207.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.856f6fff.js"><link rel="prefetch" href="/web-vue3/assets/10.optimize.html.300e0b35.js"><link rel="prefetch" href="/web-vue3/assets/11.gencode.html.b9fda889.js"><link rel="prefetch" href="/web-vue3/assets/12.mount.html.703cbef7.js"><link rel="prefetch" href="/web-vue3/assets/13._render.html.160e743b.js"><link rel="prefetch" href="/web-vue3/assets/14._update.html.b840835b.js"><link rel="prefetch" href="/web-vue3/assets/2.initGlobalAPI.html.99db2072.js"><link rel="prefetch" href="/web-vue3/assets/3.initMixin.html.107db306.js"><link rel="prefetch" href="/web-vue3/assets/4.stateMixin.html.2576e78e.js"><link rel="prefetch" href="/web-vue3/assets/5.eventsMixin.html.4ea50755.js"><link rel="prefetch" href="/web-vue3/assets/6.lifecycleMixin.html.3dcacb20.js"><link rel="prefetch" href="/web-vue3/assets/7.renderMixin.html.b32c98ce.js"><link rel="prefetch" href="/web-vue3/assets/8.mount.html.a2f5c03d.js"><link rel="prefetch" href="/web-vue3/assets/9.ast.html.b371600d.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.1f1b5592.js"><link rel="prefetch" href="/web-vue3/assets/2.use.html.9a4d62f9.js"><link rel="prefetch" href="/web-vue3/assets/3.origin.html.d577e7de.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.15afd4c5.js"><link rel="prefetch" href="/web-vue3/assets/404.html.c038a05a.js"><link rel="prefetch" href="/web-vue3/assets/index.html.95b0a427.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.4109cac8.js"><link rel="prefetch" href="/web-vue3/assets/1.utils.html.86cde9ff.js"><link rel="prefetch" href="/web-vue3/assets/10.skill.html.5657d66a.js"><link rel="prefetch" href="/web-vue3/assets/11.mock.html.f46245ad.js"><link rel="prefetch" href="/web-vue3/assets/12.optimization.html.5e50d3ce.js"><link rel="prefetch" href="/web-vue3/assets/13.deploy.html.07ebb41a.js"><link rel="prefetch" href="/web-vue3/assets/2.project.html.0b2ca0d8.js"><link rel="prefetch" href="/web-vue3/assets/3.vuecli.html.7e0457fe.js"><link rel="prefetch" href="/web-vue3/assets/4.env.html.cbc88455.js"><link rel="prefetch" href="/web-vue3/assets/5.ui.html.5f10aed8.js"><link rel="prefetch" href="/web-vue3/assets/6.layout.html.a10daefc.js"><link rel="prefetch" href="/web-vue3/assets/7.single.html.219c836f.js"><link rel="prefetch" href="/web-vue3/assets/8.page.html.b3c49e49.js"><link rel="prefetch" href="/web-vue3/assets/9.module.html.4c3286a6.js"><link rel="prefetch" href="/web-vue3/assets/1.config.html.2a4538e9.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.81bb3b21.js"><link rel="prefetch" href="/web-vue3/assets/10.server.html.059c54f3.js"><link rel="prefetch" href="/web-vue3/assets/11.pwa.html.07fed650.js"><link rel="prefetch" href="/web-vue3/assets/12.upload.html.f72eb3e2.js"><link rel="prefetch" href="/web-vue3/assets/13.video.html.aad1b8fa.js"><link rel="prefetch" href="/web-vue3/assets/2.skill.html.dd4f5f0a.js"><link rel="prefetch" href="/web-vue3/assets/3.login.html.378bd3ae.js"><link rel="prefetch" href="/web-vue3/assets/4.projectMonitor.html.7aa0cb67.js"><link rel="prefetch" href="/web-vue3/assets/5.test.html.c5829504.js"><link rel="prefetch" href="/web-vue3/assets/6.configurePrem.html.d6c72520.js"><link rel="prefetch" href="/web-vue3/assets/7.internationalization.html.c8f72201.js"><link rel="prefetch" href="/web-vue3/assets/8.errorCollection.html.ca7c565a.js"><link rel="prefetch" href="/web-vue3/assets/9.optimize.html.0e83f57e.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.8cf7453e.js"><link rel="prefetch" href="/web-vue3/assets/1.vue-cli3.html.e5658eb9.js"><link rel="prefetch" href="/web-vue3/assets/2.life.html.41aa083b.js"><link rel="prefetch" href="/web-vue3/assets/2.vue.html.52c483ae.js"><link rel="prefetch" href="/web-vue3/assets/2.vue1.html.0641550a.js"><link rel="prefetch" href="/web-vue3/assets/3.vue-router.html.0c1845f9.js"><link rel="prefetch" href="/web-vue3/assets/4.vuex.html.4987b04b.js"><link rel="prefetch" href="/web-vue3/assets/5.ui.html.e8e48718.js"><link rel="prefetch" href="/web-vue3/assets/6.vueuse.html.cea3127a.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.15fea6eb.js"><link rel="prefetch" href="/web-vue3/assets/1.singlespa.html.3ed2f2e2.js"><link rel="prefetch" href="/web-vue3/assets/1.singlespa2.html.324f7a4c.js"><link rel="prefetch" href="/web-vue3/assets/2.qiankun.html.dcb95026.js"><link rel="prefetch" href="/web-vue3/assets/2.qiankun2.html.2a0a007a.js"><link rel="prefetch" href="/web-vue3/assets/3.share.html.bcf44c42.js"><link rel="prefetch" href="/web-vue3/assets/4.dev.html.1c0401c5.js"><link rel="prefetch" href="/web-vue3/assets/1.env.html.e989b7e6.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.52c90df3.js"><link rel="prefetch" href="/web-vue3/assets/10.infer.html.06d01233.js"><link rel="prefetch" href="/web-vue3/assets/11.overlapping.html.f966b41a.js"><link rel="prefetch" href="/web-vue3/assets/12.condition.html.f64504a1.js"><link rel="prefetch" href="/web-vue3/assets/13.builtin.html.80695410.js"><link rel="prefetch" href="/web-vue3/assets/14.package.html.066def34.js"><link rel="prefetch" href="/web-vue3/assets/15.custom.html.03e5fe47.js"><link rel="prefetch" href="/web-vue3/assets/16.unknown.html.592bb2c1.js"><link rel="prefetch" href="/web-vue3/assets/17.module.html.d2802e50.js"><link rel="prefetch" href="/web-vue3/assets/18.statement.html.1152e2f8.js"><link rel="prefetch" href="/web-vue3/assets/19.extend.html.5d3ea4c0.js"><link rel="prefetch" href="/web-vue3/assets/2.base.html.79a9b9c4.js"><link rel="prefetch" href="/web-vue3/assets/3.deduction.html.a69418e9.js"><link rel="prefetch" href="/web-vue3/assets/4.type.html.94420ddd.js"><link rel="prefetch" href="/web-vue3/assets/5.class.html.bc7f61ef.js"><link rel="prefetch" href="/web-vue3/assets/6.interface.html.56d3e083.js"><link rel="prefetch" href="/web-vue3/assets/7.generic.html.9ac50bb5.js"><link rel="prefetch" href="/web-vue3/assets/8.compatible.html.3f4ea154.js"><link rel="prefetch" href="/web-vue3/assets/9.protect.html.b2795aed.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.d9966d86.js"><link rel="prefetch" href="/web-vue3/assets/1.local.html.4df5b3e1.js"><link rel="prefetch" href="/web-vue3/assets/2.gitlab.html.4053a02f.js"><link rel="prefetch" href="/web-vue3/assets/3.genkins.html.9cc6d40c.js"><link rel="prefetch" href="/web-vue3/assets/4.centos.html.982ee507.js"><link rel="prefetch" href="/web-vue3/assets/5.nginx.html.0a32d507.js"><link rel="prefetch" href="/web-vue3/assets/1.button.html.95c60e73.js"><link rel="prefetch" href="/web-vue3/assets/1.env.html.20885c7e.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.de1b877a.js"><link rel="prefetch" href="/web-vue3/assets/1.recursion.html.0253eb5f.js"><link rel="prefetch" href="/web-vue3/assets/10.tree.html.ad6a48b5.js"><link rel="prefetch" href="/web-vue3/assets/12.table.html.e21cd00d.js"><link rel="prefetch" href="/web-vue3/assets/13.publish.html.9bba74e4.js"><link rel="prefetch" href="/web-vue3/assets/2.dropdown.html.82f86b4a.js"><link rel="prefetch" href="/web-vue3/assets/3.dialog.html.d5db7aa7.js"><link rel="prefetch" href="/web-vue3/assets/4.input.html.40804795.js"><link rel="prefetch" href="/web-vue3/assets/4.render.html.6e84844c.js"><link rel="prefetch" href="/web-vue3/assets/5.checkBox.html.da3c2254.js"><link rel="prefetch" href="/web-vue3/assets/6.cascader.html.432f5bc3.js"><link rel="prefetch" href="/web-vue3/assets/7.date.html.59c8c38f.js"><link rel="prefetch" href="/web-vue3/assets/8.dispaly.html.8ee5c8ea.js"><link rel="prefetch" href="/web-vue3/assets/9.alert.html.90100b92.js"><link rel="prefetch" href="/web-vue3/assets/9.dynamics.html.f74e3282.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.9a606624.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.d0e61b08.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.ecb82c00.js"><link rel="prefetch" href="/web-vue3/assets/10.optimize.html.8fab6090.js"><link rel="prefetch" href="/web-vue3/assets/11.gencode.html.0a1bdbcf.js"><link rel="prefetch" href="/web-vue3/assets/12.mount.html.b699c425.js"><link rel="prefetch" href="/web-vue3/assets/13._render.html.7a6aa852.js"><link rel="prefetch" href="/web-vue3/assets/14._update.html.99415da3.js"><link rel="prefetch" href="/web-vue3/assets/2.initGlobalAPI.html.ceb1f87b.js"><link rel="prefetch" href="/web-vue3/assets/3.initMixin.html.7015a932.js"><link rel="prefetch" href="/web-vue3/assets/4.stateMixin.html.c2406535.js"><link rel="prefetch" href="/web-vue3/assets/5.eventsMixin.html.c23ab67f.js"><link rel="prefetch" href="/web-vue3/assets/6.lifecycleMixin.html.167946fb.js"><link rel="prefetch" href="/web-vue3/assets/7.renderMixin.html.414350af.js"><link rel="prefetch" href="/web-vue3/assets/8.mount.html.baeba562.js"><link rel="prefetch" href="/web-vue3/assets/9.ast.html.5c18e82d.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.365131aa.js"><link rel="prefetch" href="/web-vue3/assets/2.use.html.53555ad6.js"><link rel="prefetch" href="/web-vue3/assets/3.origin.html.7011300f.js"><link rel="prefetch" href="/web-vue3/assets/1.index.html.c8cb6073.js"><link rel="prefetch" href="/web-vue3/assets/404.html.1820d32f.js">
    <link rel="stylesheet" href="/web-vue3/assets/style.935d4578.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/web-vue3/" class=""><!----><span class="site-name">Vue3.x学习笔记</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="基础知识"><span class="title">基础知识</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="基础知识"><span class="title">基础知识</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web-vue3/base/engine/1.index" class="" aria-label="一.Vue 的工程化"><!--[--><!--]--> 一.Vue 的工程化 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/base/project/1.index" class="" aria-label="二.Vue 功能模块"><!--[--><!--]--> 二.Vue 功能模块 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/base/vue3.x/1.index" class="" aria-label="三.Vue 3.x全家桶"><!--[--><!--]--> 三.Vue 3.x全家桶 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="高级知识"><span class="title">高级知识</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="高级知识"><span class="title">高级知识</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web-vue3/senior/2.typescript/1.index" class="" aria-label="一.TypeScript"><!--[--><!--]--> 一.TypeScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/senior/3.deploy/1.index" class="" aria-label="二.构建部署"><!--[--><!--]--> 二.构建部署 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/senior/4.component/1.index" class="" aria-label="三.组件开发"><!--[--><!--]--> 三.组件开发 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Vue 3.x源码"><span class="title">Vue 3.x源码</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Vue 3.x源码"><span class="title">Vue 3.x源码</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web-vue3/source/vue-cli3.x/1.index" class="" aria-label="一.Vue/cli3.x"><!--[--><!--]--> 一.Vue/cli3.x <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/source/vue3.x/1.index" class="" aria-label="二.Vue 3.x"><!--[--><!--]--> 二.Vue 3.x <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/source/vue-router4.x/1.index" class="" aria-label="三.Vue-Router4.x"><!--[--><!--]--> 三.Vue-Router4.x <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/source/vuex4.x/1.index" class="" aria-label="四.Vuex4.x"><!--[--><!--]--> 四.Vuex4.x <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/web-vue3/read" class="" aria-label="Vue资料"><!--[--><!--]--> Vue资料 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="基础知识"><span class="title">基础知识</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="基础知识"><span class="title">基础知识</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web-vue3/base/engine/1.index" class="" aria-label="一.Vue 的工程化"><!--[--><!--]--> 一.Vue 的工程化 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/base/project/1.index" class="" aria-label="二.Vue 功能模块"><!--[--><!--]--> 二.Vue 功能模块 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/base/vue3.x/1.index" class="" aria-label="三.Vue 3.x全家桶"><!--[--><!--]--> 三.Vue 3.x全家桶 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="高级知识"><span class="title">高级知识</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="高级知识"><span class="title">高级知识</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web-vue3/senior/2.typescript/1.index" class="" aria-label="一.TypeScript"><!--[--><!--]--> 一.TypeScript <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/senior/3.deploy/1.index" class="" aria-label="二.构建部署"><!--[--><!--]--> 二.构建部署 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/senior/4.component/1.index" class="" aria-label="三.组件开发"><!--[--><!--]--> 三.组件开发 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Vue 3.x源码"><span class="title">Vue 3.x源码</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Vue 3.x源码"><span class="title">Vue 3.x源码</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/web-vue3/source/vue-cli3.x/1.index" class="" aria-label="一.Vue/cli3.x"><!--[--><!--]--> 一.Vue/cli3.x <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/source/vue3.x/1.index" class="" aria-label="二.Vue 3.x"><!--[--><!--]--> 二.Vue 3.x <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/source/vue-router4.x/1.index" class="" aria-label="三.Vue-Router4.x"><!--[--><!--]--> 三.Vue-Router4.x <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/web-vue3/source/vuex4.x/1.index" class="" aria-label="四.Vuex4.x"><!--[--><!--]--> 四.Vuex4.x <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a href="/web-vue3/read" class="" aria-label="Vue资料"><!--[--><!--]--> Vue资料 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/web-vue3/senior/4.component/1.index.html" class="sidebar-item sidebar-heading" aria-label="Vue的组件开发"><!--[--><!--]--> Vue的组件开发 <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/1.button.html" class="sidebar-item sidebar-heading" aria-label="一.命令输入（按钮）"><!--[--><!--]--> 一.命令输入（按钮） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/2.dropdown.html" class="sidebar-item sidebar-heading" aria-label="一.命令输入（下拉菜单）"><!--[--><!--]--> 一.命令输入（下拉菜单） <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web-vue3/senior/4.component/3.form.html" class="router-link-active router-link-exact-active router-link-active sidebar-item sidebar-heading active" aria-label="二.数据输入（表单）"><!--[--><!--]--> 二.数据输入（表单） <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/web-vue3/senior/4.component/3.form.html#_1-目录结构" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.目录结构"><!--[--><!--]--> 1.目录结构 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web-vue3/senior/4.component/3.form.html#_2-接口设计" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.接口设计"><!--[--><!--]--> 2.接口设计 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web-vue3/senior/4.component/3.form.html#_3-在-form-中缓存-formitem-实例" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.在 Form 中缓存 FormItem 实例"><!--[--><!--]--> 3.在 Form 中缓存 FormItem 实例 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/web-vue3/senior/4.component/3.form.html#_4-触发校验" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.触发校验"><!--[--><!--]--> 4.触发校验 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a href="/web-vue3/senior/4.component/4.input.html" class="sidebar-item sidebar-heading" aria-label="二.数据输入（输入框）"><!--[--><!--]--> 二.数据输入（输入框） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/5.checkBox.html" class="sidebar-item sidebar-heading" aria-label="二.数据输入（单/复选框）"><!--[--><!--]--> 二.数据输入（单/复选框） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/6.cascader.html" class="sidebar-item sidebar-heading" aria-label="二.数据输入（级联选择）"><!--[--><!--]--> 二.数据输入（级联选择） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/7.date.html" class="sidebar-item sidebar-heading" aria-label="二.数据输入（日期）"><!--[--><!--]--> 二.数据输入（日期） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/8.dispaly.html" class="sidebar-item sidebar-heading" aria-label="二.数据输入（动态渲染）"><!--[--><!--]--> 二.数据输入（动态渲染） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/9.dynamics.html" class="sidebar-item sidebar-heading" aria-label="二.数据输入（动态）"><!--[--><!--]--> 二.数据输入（动态） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/1.env.html" class="sidebar-item sidebar-heading" aria-label="二.数据输入（富文本）"><!--[--><!--]--> 二.数据输入（富文本） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/10.tree.html" class="sidebar-item sidebar-heading" aria-label="三.数据输出（树）"><!--[--><!--]--> 三.数据输出（树） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/12.table.html" class="sidebar-item sidebar-heading" aria-label="三.数据输出（表格）"><!--[--><!--]--> 三.数据输出（表格） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/1.recursion.html" class="sidebar-item sidebar-heading" aria-label="六.导航（菜单）"><!--[--><!--]--> 六.导航（菜单） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/3.dialog.html" class="sidebar-item sidebar-heading" aria-label="七.特殊窗口（对话框）"><!--[--><!--]--> 七.特殊窗口（对话框） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/4.render.html" class="sidebar-item sidebar-heading" aria-label="五.render"><!--[--><!--]--> 五.render <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/9.alert.html" class="sidebar-item sidebar-heading" aria-label="七.特殊窗口（警告提示）"><!--[--><!--]--> 七.特殊窗口（警告提示） <!--[--><!--]--></a><!----></li><li><a href="/web-vue3/senior/4.component/13.publish.html" class="sidebar-item sidebar-heading" aria-label="十三.组件发布"><!--[--><!--]--> 十三.组件发布 <!--[--><!--]--></a><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="二-数据输入-表单" tabindex="-1"><a class="header-anchor" href="#二-数据输入-表单" aria-hidden="true">#</a> 二.数据输入（表单）</h1><div class="custom-container tip"><p class="custom-container-title">前言 --&gt; 表单组件特点</p><ul><li>Form 组件分为两个部分： <ul><li>外层的<code>Form</code>表单域组件，一组表单控件只有一个 Form</li><li>内部包含了多个<code>FormItem</code>组件，每一个表单控件都被一个 FormItem 包裹</li></ul></li><li>它的主要功能包括： <ul><li>数据校验，并在对应的 FormItem 中给出校验失败的提示(<code>async-validator</code>)</li><li>鼠标滑出下拉菜单组件，隐藏待选菜单</li><li>鼠标点击待选菜单中的条目，选中项文本更新，组件派发 change 事件</li></ul></li></ul></div><h2 id="_1-目录结构" tabindex="-1"><a class="header-anchor" href="#_1-目录结构" aria-hidden="true">#</a> 1.目录结构</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">├── form</span></span>
<span class="line"><span style="color:#24292F;">│   ├── form-item.vue</span></span>
<span class="line"><span style="color:#24292F;">│   ├── form.vue</span></span>
<span class="line"><span style="color:#24292F;">│   └── index.js</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-接口设计" tabindex="-1"><a class="header-anchor" href="#_2-接口设计" aria-hidden="true">#</a> 2.接口设计</h2><p>而 Form 和 FormItem 两个组件主要做数据校验，用不到 events。Form 的 slot 就是一系列的 FormItem，FormItem 的 solt 就是具体的表单控件，比如输入框。</p><p>在<code>Form</code>组件中，定义两个 props:</p><ul><li><p>model:表单控件绑定的数据对象，在校验或重置时会访问该数据对象下对应的表单数据，类型为 Object</p></li><li><p>rules:表单验证规则，即上面介绍的 async-validator 所使用的校验规则，类型为 Object</p><p>在<code>FormItem</code>组件中，也定义两个 props:</p></li><li><p>label:单个表单组件的标签文本，类似原生<code>&lt;label&gt;</code>元素，类型为 String</p></li><li><p>prop:对应表单域 Form 组件 model 里的字段，用于校验或重置时访问表单组件绑定的数据，类型为 String</p></li></ul><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">i-form</span><span style="color:#24292F;"> :</span><span style="color:#0550AE;">model</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">formValidate</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;"> :</span><span style="color:#0550AE;">rules</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">ruleValidate</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;</span><span style="color:#116329;">i-form-item</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">label</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;用户名&quot;</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">prop</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;name&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">        &lt;</span><span style="color:#116329;">i-input</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-model</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">formValidate.name</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">i-input</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;/</span><span style="color:#116329;">i-form-item</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;</span><span style="color:#116329;">i-form-item</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">label</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;邮箱&quot;</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">prop</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;mail&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">        &lt;</span><span style="color:#116329;">i-input</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-model</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">formValidate.mail</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">i-input</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;/</span><span style="color:#116329;">i-form-item</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;/</span><span style="color:#116329;">i-form</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> iForm form </span><span style="color:#0A3069;">&#39;../components/form/form.vue&#39;</span></span>
<span class="line"><span style="color:#24292F;">import iFormItem </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;../components/form/form-item.vue&#39;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> iInput </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;../components/input/input.vue&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">components: {</span></span>
<span class="line"><span style="color:#24292F;">    iForm,</span></span>
<span class="line"><span style="color:#24292F;">    iFormItem,</span></span>
<span class="line"><span style="color:#24292F;">    iInput</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">data</span><span style="color:#953800;">()</span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      formValidate:{</span></span>
<span class="line"><span style="color:#24292F;">        name: </span><span style="color:#0A3069;">&#39;&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">        mail: </span><span style="color:#0A3069;">&#39;&#39;</span></span>
<span class="line"><span style="color:#24292F;">      },</span></span>
<span class="line"><span style="color:#24292F;">      ruleValidate: {</span></span>
<span class="line"><span style="color:#24292F;">        name: [</span></span>
<span class="line"><span style="color:#24292F;">          {required:</span><span style="color:#0550AE;">true</span><span style="color:#24292F;">,message:</span><span style="color:#0A3069;">&#39;用户名称不能为空&#39;</span><span style="color:#24292F;">,trigger:</span><span style="color:#0A3069;">&#39;blur&#39;</span><span style="color:#24292F;">}</span></span>
<span class="line"><span style="color:#24292F;">        ],</span></span>
<span class="line"><span style="color:#24292F;">        mail: [</span></span>
<span class="line"><span style="color:#24292F;">          {required:</span><span style="color:#0550AE;">true</span><span style="color:#24292F;">, message:</span><span style="color:#0A3069;">&#39;邮箱不能为空&#39;</span><span style="color:#24292F;">,trigger:</span><span style="color:#0A3069;">&#39;blur&#39;</span><span style="color:#24292F;">},</span></span>
<span class="line"><span style="color:#24292F;">          {type:</span><span style="color:#0A3069;">&#39;email&#39;</span><span style="color:#24292F;">,message:</span><span style="color:#0A3069;">&#39;邮箱格式不正确&#39;</span><span style="color:#24292F;">,trigger:</span><span style="color:#0A3069;">&#39;blur&#39;</span><span style="color:#24292F;">}</span></span>
<span class="line"><span style="color:#24292F;">        ]</span></span>
<span class="line"><span style="color:#24292F;">      }</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">/* form.vue */</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">form</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">slot</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">slot</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;/</span><span style="color:#116329;">form</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">name: </span><span style="color:#0A3069;">&quot;iForm&quot;</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">props: {</span></span>
<span class="line"><span style="color:#24292F;">    model: {</span></span>
<span class="line"><span style="color:#24292F;">      type: </span><span style="color:#0550AE;">Object</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    rules: {</span></span>
<span class="line"><span style="color:#24292F;">      type: </span><span style="color:#0550AE;">Object</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">/* form-item.vue */</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">label</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-if</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">label</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;{{ label }}&lt;/</span><span style="color:#116329;">label</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;</span><span style="color:#116329;">slot</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">slot</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">name: </span><span style="color:#0A3069;">&quot;iFormItem&quot;</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">props: {</span></span>
<span class="line"><span style="color:#24292F;">    label: {</span></span>
<span class="line"><span style="color:#24292F;">      type: </span><span style="color:#0550AE;">String</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">      default: </span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    prop: {</span></span>
<span class="line"><span style="color:#24292F;">      type: </span><span style="color:#0550AE;">String</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_3-在-form-中缓存-formitem-实例" tabindex="-1"><a class="header-anchor" href="#_3-在-form-中缓存-formitem-实例" aria-hidden="true">#</a> 3.在 Form 中缓存 FormItem 实例</h2><p><code>Form</code>组件的核心功能是数据校验，一个 Form 中包含了多个 FormTtem,当点击提交按钮时，要逐一对每一个 FormItem 内的表单组件校验，而校验是由使用者发起，并通过<code>Form</code>来掉用每一个<code>FormItem</code>的验证方法，再将校验结果汇总后，通过<code>Form</code>返回出去。</p><p>因为要在 Form 中逐一调用 FormItem 的验证方法，而 Form 和 FormItem 是独立的，需要预先将 FormItem 的每个实例缓存在 Form 中。每当 FormItem 渲染时，将其自身作为参数通过<code>dispatch</code>派发到<code>Form</code>组件中，然后通过一个数组缓存起来；同理当 FormItem 销毁时，将其从 Form 缓存的数组中移除</p><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> Emitter </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;../../mixins/emitter.js&quot;</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">name: </span><span style="color:#0A3069;">&quot;iFormItem&quot;</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">mixins: [Emitter]</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">mounted</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">dispatch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;iForm&quot;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&quot;on-form-item-add&quot;</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">beforeDestory</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">dispatch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;iForm&quot;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&quot;on-form-item-remove&quot;</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>组件渲染顺序是由内而外的，所以 FormItem 要先于 Form 渲染，在 FormItem 的 mounted 触发时，我们向 Form 派发了事件<code>on-form-item-add</code>，并将当前 FormItem 的实例(this)传递给了 Form,而此时，Form 的 mounted 尚未触发，因为 Form 在最外层，如果 Form 的 mounted 里监听事件，是不可以的，所以要在其 created 内监听自定义事件，Form 的 created 要先于 FormItem 的 mounted。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">name: </span><span style="color:#0A3069;">&quot;iForm&quot;</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">data</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      fields: [],</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">created</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">$on</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;on-form-item-add&quot;</span><span style="color:#24292F;">, (</span><span style="color:#953800;">field</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (field) </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.fields.</span><span style="color:#8250DF;">push</span><span style="color:#24292F;">(field)</span></span>
<span class="line"><span style="color:#24292F;">    })</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">$on</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;on-form-item-remove&quot;</span><span style="color:#24292F;">, (</span><span style="color:#953800;">filed</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (field.prop) </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.fields.</span><span style="color:#8250DF;">splice</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.fields.</span><span style="color:#8250DF;">indexOf</span><span style="color:#24292F;">(field), </span><span style="color:#0550AE;">1</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">    })</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>定义的数据<code>fields</code>就是用来缓存所有 FormItem 实例的。</p><h2 id="_4-触发校验" tabindex="-1"><a class="header-anchor" href="#_4-触发校验" aria-hidden="true">#</a> 4.触发校验</h2><p>Form 支持两种事件来触发校验：</p><ul><li>blur: 失去焦点时触发，常见的有输入框失去焦点时触发校验</li><li>change：实时输入是触发或选择时触发，常见的有输入框实时输入时触发校验、下拉选择器选择项目时触发校验等</li></ul><p>以上两个事件，都是有具体的表单组件来触发的，我们先来编写一个简单的输入框组件<code>i-input</code>。在<code>components</code>下新建目录<code>input</code>，创建文件<code>input.vue</code></p><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">input</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#0550AE;">type</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;text&quot;</span></span>
<span class="line"><span style="color:#24292F;">    :</span><span style="color:#0550AE;">value</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">currentValue</span><span style="color:#0A3069;">&quot;</span></span>
<span class="line"><span style="color:#24292F;">    @</span><span style="color:#0550AE;">input</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">handleInput</span><span style="color:#0A3069;">&quot;</span></span>
<span class="line"><span style="color:#24292F;">    @</span><span style="color:#0550AE;">blur</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">handleBlur</span><span style="color:#0A3069;">&quot;</span></span>
<span class="line"><span style="color:#24292F;">  /&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> Emitter </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;../../mixins/emitter.js&#39;</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">default</span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">name</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&#39;iInput&#39;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">mixins</span><span style="color:#24292F;">:[Emitter],</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">props</span><span style="color:#24292F;">:{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#953800;">value</span><span style="color:#24292F;">:{</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#953800;">type</span><span style="color:#24292F;">:</span><span style="color:#0550AE;">String</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">default</span><span style="color:#24292F;">:</span><span style="color:#0A3069;">&#39;</span></span>
<span class="line"><span style="color:#0A3069;">    </span><span style="color:#82071E;font-style:italic;">}</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#8250DF;">data</span><span style="color:#24292F;">(){</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      currentValue:</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.value</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">watch</span><span style="color:#24292F;">:{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">value</span><span style="color:#24292F;">(value){</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.currentValue</span><span style="color:#CF222E;">=</span><span style="color:#24292F;">val</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  },</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#953800;">methods</span><span style="color:#24292F;">:{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">handleInput</span><span style="color:#24292F;">(event){</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">value</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> event.target.value</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.currentValue</span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> value</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">$emit</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;input&#39;</span><span style="color:#24292F;">,value)</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">dispatch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;iFormItem&#39;</span><span style="color:#24292F;">,</span><span style="color:#0A3069;">&#39;on-form-change&#39;</span><span style="color:#24292F;">,value)</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">handleBlur</span><span style="color:#24292F;">(){</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">dispatch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;iFormItem&#39;</span><span style="color:#24292F;">,</span><span style="color:#0A3069;">&#39;on-from-blur&#39;</span><span style="color:#24292F;">,</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.currentValue)</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"><span style="color:#CF222E;">&lt;/</span><span style="color:#24292F;">script</span><span style="color:#CF222E;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>input 组件中，绑定在<code>&lt;input&gt;</code>元素上的原生事件<code>@input</code>，每当输入一个字符，都会调用句柄<code>handleInput</code>,并通过<code>dispatch</code>方法向上级的 FormItem 组件派发自定义事件<code>on-form-change</code>;同理，绑定的原生事件<code>@blur</code>会在 input 失焦时触发，并传递事件<code>on-form-blur</code>。</p><p>基础组件有了，接下来要做的，是在 FormItem 中监听 input 组件派发的自定义事件。这里可以在 mounted 中监听，因为你的手速远赶不上组件的渲染速度，不过在 created 中监听也是没有任何问题的。</p><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#6E7781;">// form-item.vue</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">methods: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">setRules</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">$on</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;on-form-blur&quot;</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.onFieldBlur)</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">$on</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;on-form-change&quot;</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.onFieldChange)</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">mounted</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop) {</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">dispatch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;iForm&quot;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&quot;on-form-item-add&quot;</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">setRules</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">      }</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过调用<code>setRules</code>方法，监听表单组件的两个事件，并绑定了句柄函数<code>onFieldBlur</code>和<code>onFiledChange</code>,分别对应 blur 和 change 两种事件类型。当 onFieldBlur 或 onFieldChange 函数触发时，就意味着 FormItem 要对当前的数据进行一次校验。当前的数据，指的就是通过表单域 Form 中定义的 props:model，结合当前 FormItem 定义的 props:props 来确定的数据，可以回顾上文写过的用例。</p><p>因为 FormItem 中只定义了数据源的某个 key 名称（即属性 prop）,要拿到 Form 中 model 里的数据，需要用到 provide/inject。所以在 Form 中，把整个实例(this)向下提供，并在 FormItem 中注入：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#6E7781;">// form.vue，部分代码省略</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">provide</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      form: </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#6E7781;">// form-item.vue，部分代码省略</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">inject: [</span><span style="color:#0A3069;">&quot;form&quot;</span><span style="color:#24292F;">]</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>准备好这些，接着就是最核心的校验功能了。blur 和 change 事件都会触发校验，它们调用同一个方法，只是参数不同。相关代码如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#6E7781;">// form-item.vue，部分代码省略</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> AsyncValidator </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;async-validator&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">inject: [</span><span style="color:#0A3069;">&quot;form&quot;</span><span style="color:#24292F;">]</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">props: {</span></span>
<span class="line"><span style="color:#24292F;">    prop: {</span></span>
<span class="line"><span style="color:#24292F;">      type: </span><span style="color:#0550AE;">String</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">data</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      validateState: </span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">, </span><span style="color:#6E7781;">// 校验状态</span></span>
<span class="line"><span style="color:#24292F;">      validateMessage: </span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">, </span><span style="color:#6E7781;">// 校验不通过时的提示信息</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">computed: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// 从 Form 的 model 中动态得到当前表单组件的数据</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">fieldValue</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.form.model[</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop]</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">methods: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// 从 Form 的 rules 属性中，获取当前 FormItem 的校验规则</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">getRules</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">let</span><span style="color:#24292F;"> formRules </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.form.rules</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      formRules </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> formRules </span><span style="color:#CF222E;">?</span><span style="color:#24292F;"> formRules[</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop] </span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> [].</span><span style="color:#8250DF;">concat</span><span style="color:#24292F;">(formRules </span><span style="color:#CF222E;">||</span><span style="color:#24292F;"> [])</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// 只支持 blur 和 change，所以过滤出符合要求的 rule 规则</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">getFilteredRule</span><span style="color:#24292F;">(</span><span style="color:#953800;">trigger</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">rules</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">getRules</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> rules.</span><span style="color:#8250DF;">filter</span><span style="color:#24292F;">(</span></span>
<span class="line"><span style="color:#24292F;">        (</span><span style="color:#953800;">rule</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">!</span><span style="color:#24292F;">rule.trigger </span><span style="color:#CF222E;">||</span><span style="color:#24292F;"> rule.trigger.</span><span style="color:#8250DF;">indexOf</span><span style="color:#24292F;">(trigger) </span><span style="color:#CF222E;">!==</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">-</span><span style="color:#0550AE;">1</span></span>
<span class="line"><span style="color:#24292F;">      )</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">/**</span></span>
<span class="line"><span style="color:#6E7781;">     * 校验数据</span></span>
<span class="line"><span style="color:#6E7781;">     * </span><span style="color:#CF222E;">@param</span><span style="color:#6E7781;"> </span><span style="color:#24292F;">trigger</span><span style="color:#6E7781;"> 校验类型</span></span>
<span class="line"><span style="color:#6E7781;">     * </span><span style="color:#CF222E;">@param</span><span style="color:#6E7781;"> </span><span style="color:#24292F;">callback</span><span style="color:#6E7781;"> 回调函数</span></span>
<span class="line"><span style="color:#6E7781;">     */</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">(</span><span style="color:#953800;">trigger</span><span style="color:#24292F;">, </span><span style="color:#8250DF;">callback</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">function</span><span style="color:#24292F;">() {}) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">let</span><span style="color:#24292F;"> rules </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">getFilteredRule</span><span style="color:#24292F;">(trigger)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (</span><span style="color:#CF222E;">!</span><span style="color:#24292F;">rules </span><span style="color:#CF222E;">||</span><span style="color:#24292F;"> rules.</span><span style="color:#0550AE;">length</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">0</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">true</span></span>
<span class="line"><span style="color:#24292F;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#6E7781;">// 设置状态为校验中</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.validateState </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;validating&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#6E7781;">// 以下为 async-validator 库的调用方法</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">let</span><span style="color:#24292F;"> descriptor </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> {}</span></span>
<span class="line"><span style="color:#24292F;">      descriptor[</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop] </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> rules</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">validator</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#8250DF;">AsyncValidator</span><span style="color:#24292F;">(descriptor)</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">let</span><span style="color:#24292F;"> model </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> {}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      model[</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop] </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.fieldValue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      validator.</span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">(model, { firstFields: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;"> }, (</span><span style="color:#953800;">errors</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.validateState </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">!</span><span style="color:#24292F;">errors </span><span style="color:#CF222E;">?</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;success&quot;</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;error&quot;</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.validateMessage </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> errors </span><span style="color:#CF222E;">?</span><span style="color:#24292F;"> errors[</span><span style="color:#0550AE;">0</span><span style="color:#24292F;">].message </span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#8250DF;">callback</span><span style="color:#24292F;">(</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.validateMessage)</span></span>
<span class="line"><span style="color:#24292F;">      })</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">onFieldBlur</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;blur&quot;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">onFieldChange</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;change&quot;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 FormItem 的 <code>validate()</code> 方法中，最终做了两件事：</p><ol><li>设置了当前的校验状态 <code>validateState</code> 和校验不通过提示信息 <code>validateMessage</code>（通过值为空）；</li><li>将 validateMessage 通过回调 callback 传递给调用者，这里的调用者是 onFieldBlur 和 onFieldChange，它们只传入了第一个参数 <code>trigger</code>，callback 并未传入，因此也不会触发回调，而这个回调主要是给 Form 用的，因为 Form 中可以通过提交按钮一次性校验所有的 FormItem（后文会介绍）这里只是表单组件触发事件时，对当前 FormItem 做校验。</li></ol><p>除了校验，还可以对当前数据进行重置。重置是指将表单组件的数据还原到最初绑定的值，而不是清空，因此需要预先缓存一份初始值。同时我们将校验信息也显示在模板中，并加一些样式。相关代码如下：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#6E7781;">&lt;!-- form-item.vue，部分代码省略 --&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">label</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-if</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">label</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;"> :</span><span style="color:#0550AE;">class</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">{ </span><span style="color:#0A3069;">&#39;i-form-item-label-required&#39;</span><span style="color:#24292F;">: isRequired }</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;{{</span></span>
<span class="line"><span style="color:#24292F;">      label</span></span>
<span class="line"><span style="color:#24292F;">    }}&lt;/</span><span style="color:#116329;">label</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;</span><span style="color:#116329;">slot</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">slot</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-if</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">validateState </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&#39;error&#39;&quot;</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">class</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;i-form-item-message&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">        {{ validateMessage }}</span></span>
<span class="line"><span style="color:#24292F;">      &lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">props: {</span></span>
<span class="line"><span style="color:#24292F;">    label: {</span></span>
<span class="line"><span style="color:#24292F;">      type: </span><span style="color:#0550AE;">String</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">      default: </span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    prop: {</span></span>
<span class="line"><span style="color:#24292F;">      type: </span><span style="color:#0550AE;">String</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">data</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      isRequired: </span><span style="color:#0550AE;">false</span><span style="color:#24292F;">, </span><span style="color:#6E7781;">// 是否为必填</span></span>
<span class="line"><span style="color:#24292F;">      validateState: </span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">, </span><span style="color:#6E7781;">// 校验状态</span></span>
<span class="line"><span style="color:#24292F;">      validateMessage: </span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">, </span><span style="color:#6E7781;">// 校验不通过时的提示信息</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">mounted</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// 如果没有传入 prop，则无需校验，也就无需缓存</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">dispatch</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;iForm&quot;</span><span style="color:#24292F;">, </span><span style="color:#0A3069;">&quot;on-form-item-add&quot;</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#6E7781;">// 设置初始值，以便在重置时恢复默认值</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.initialValue </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.fieldValue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">setRules</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">methods: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">setRules</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">let</span><span style="color:#24292F;"> rules </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">getRules</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (rules.</span><span style="color:#0550AE;">length</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">        rules.</span><span style="color:#8250DF;">every</span><span style="color:#24292F;">((</span><span style="color:#953800;">rule</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#6E7781;">// 如果当前校验规则中有必填项，则标记出来</span></span>
<span class="line"><span style="color:#24292F;">          </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.isRequired </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> rule.required</span></span>
<span class="line"><span style="color:#24292F;">        })</span></span>
<span class="line"><span style="color:#24292F;">      }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">$on</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;on-form-blur&quot;</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.onFieldBlur)</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.</span><span style="color:#8250DF;">$on</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;on-form-change&quot;</span><span style="color:#24292F;">, </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.onFieldChange)</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// 从 Form 的 rules 属性中，获取当前 FormItem 的校验规则</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">getRules</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">let</span><span style="color:#24292F;"> formRules </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.form.rules</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      formRules </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> formRules </span><span style="color:#CF222E;">?</span><span style="color:#24292F;"> formRules[</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop] </span><span style="color:#CF222E;">:</span><span style="color:#24292F;"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> [].</span><span style="color:#8250DF;">concat</span><span style="color:#24292F;">(formRules </span><span style="color:#CF222E;">||</span><span style="color:#24292F;"> [])</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// 重置数据</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">resetField</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.validateState </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;&quot;</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.validateMessage </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.form.model[</span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.prop] </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.initialValue</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">style</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#0550AE;">.i-form-item-label-required:before</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">content</span><span style="color:#24292F;">: </span><span style="color:#0A3069;">&quot;*&quot;</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">color</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">red</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"><span style="color:#0550AE;">.i-form-item-message</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#0550AE;">color</span><span style="color:#24292F;">: </span><span style="color:#0550AE;">red</span><span style="color:#24292F;">;</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">style</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>至此，FormItem 代码已经完成，不过它只具有单独校验的功能，也就是说，只能对自己的一个表单组件验证，不能对一个表单域里的所有组件一次性全部校验。而实现全部校验和全部重置的功能，要在 Form 中完成。</p><p>上文已经介绍到，在 <code>Form</code> 组件中，预先缓存了全部的 FormItem 实例，自然也能在 Form 中调用它们。通过点击提交按钮全部校验，或点击重置按钮全部重置数据，只需要在 Form 中，逐一调用缓存的 FormItem 实例中的 <code>validate</code> 或 <code>resetField</code> 方法。相关代码如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#6E7781;">// form.vue，部分代码省略</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">data</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      fields: [],</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">methods: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// 公开方法：全部重置数据</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">resetFields</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.fields.</span><span style="color:#8250DF;">forEach</span><span style="color:#24292F;">((</span><span style="color:#953800;">field</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">        field.</span><span style="color:#8250DF;">resetField</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">      })</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#6E7781;">// 公开方法：全部校验数据，支持 Promise</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">(</span><span style="color:#953800;">callback</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">new</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">Promise</span><span style="color:#24292F;">((</span><span style="color:#953800;">resolve</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#CF222E;">let</span><span style="color:#24292F;"> valid </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">true</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#CF222E;">let</span><span style="color:#24292F;"> count </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">0</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.fields.</span><span style="color:#8250DF;">forEach</span><span style="color:#24292F;">((</span><span style="color:#953800;">field</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">          field.</span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">, (</span><span style="color:#953800;">errors</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">            </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (errors) {</span></span>
<span class="line"><span style="color:#24292F;">              valid </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">false</span></span>
<span class="line"><span style="color:#24292F;">            }</span></span>
<span class="line"><span style="color:#24292F;">            </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (</span><span style="color:#CF222E;">++</span><span style="color:#24292F;">count </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.fields.</span><span style="color:#0550AE;">length</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">              </span><span style="color:#6E7781;">// 全部完成</span></span>
<span class="line"><span style="color:#24292F;">              </span><span style="color:#8250DF;">resolve</span><span style="color:#24292F;">(valid)</span></span>
<span class="line"><span style="color:#24292F;">              </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (</span><span style="color:#CF222E;">typeof</span><span style="color:#24292F;"> callback </span><span style="color:#CF222E;">===</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;function&quot;</span><span style="color:#24292F;">) {</span></span>
<span class="line"><span style="color:#24292F;">                </span><span style="color:#8250DF;">callback</span><span style="color:#24292F;">(valid)</span></span>
<span class="line"><span style="color:#24292F;">              }</span></span>
<span class="line"><span style="color:#24292F;">            }</span></span>
<span class="line"><span style="color:#24292F;">          })</span></span>
<span class="line"><span style="color:#24292F;">        })</span></span>
<span class="line"><span style="color:#24292F;">      })</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>虽然说 Vue.js 的 API 只来自 prop、event、slot 这三个部分，但一些场景下，需要通过 <code>ref</code> 来访问这个组件，调用它的一些内置方法，比如上面的 <code>validate</code> 和 <code>resetFields</code> 方法，就需要使用者来主动调用。</p><p>resetFields 很简单，就是通过循环逐一调用 FormItem 的 resetField 方法来重置数据。validate 稍显复杂，它支持两种使用方法，一种是普通的回调，比如：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">i-form</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">ref</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;form&quot;</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">i-form</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">button</span><span style="color:#24292F;"> @</span><span style="color:#0550AE;">click</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">handleSubmit</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;提交&lt;/</span><span style="color:#116329;">button</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">methods: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">handleSubmit</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.$refs.form.</span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">((</span><span style="color:#953800;">valid</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (valid) {</span></span>
<span class="line"><span style="color:#24292F;">          window.</span><span style="color:#8250DF;">alert</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;提交成功&quot;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">        } </span><span style="color:#CF222E;">else</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">          window.</span><span style="color:#8250DF;">alert</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;表单校验失败&quot;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">        }</span></span>
<span class="line"><span style="color:#24292F;">      })</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同时也支持 Promise，例如：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#8250DF;">handleSubmit</span><span style="color:#24292F;"> () {</span></span>
<span class="line"><span style="color:#24292F;">  </span><span style="color:#CF222E;">const</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">validate</span><span style="color:#24292F;"> </span><span style="color:#CF222E;">=</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.$refs.form.</span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292F;">  validate.</span><span style="color:#8250DF;">then</span><span style="color:#24292F;">((</span><span style="color:#953800;">valid</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (valid) {</span></span>
<span class="line"><span style="color:#24292F;">      window.</span><span style="color:#8250DF;">alert</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;提交成功&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">    } </span><span style="color:#CF222E;">else</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      window.</span><span style="color:#8250DF;">alert</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&#39;表单校验失败&#39;</span><span style="color:#24292F;">);</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  })</span></span>
<span class="line"><span style="color:#24292F;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 Form 组件定义的 Promise 中，只调用了 resolve(valid)，没有调用 reject()，因此不能直接使用 <code>.catch()</code> ，不过聪明的你稍作修改，肯定能够支持到！</p><p>完整的用例如下：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="shiki" style="background-color:#ffffff;"><code><span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">h3</span><span style="color:#24292F;">&gt;具有数据校验功能的表单组件——Form&lt;/</span><span style="color:#116329;">h3</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">i-form</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">ref</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;form&quot;</span><span style="color:#24292F;"> :</span><span style="color:#0550AE;">model</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">formValidate</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;"> :</span><span style="color:#0550AE;">rules</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">ruleValidate</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;</span><span style="color:#116329;">i-form-item</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">label</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;用户名&quot;</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">prop</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;name&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">        &lt;</span><span style="color:#116329;">i-input</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-model</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">formValidate.name</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">i-input</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;/</span><span style="color:#116329;">i-form-item</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;</span><span style="color:#116329;">i-form-item</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">label</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;邮箱&quot;</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">prop</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;mail&quot;</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">        &lt;</span><span style="color:#116329;">i-input</span><span style="color:#24292F;"> </span><span style="color:#0550AE;">v-model</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">formValidate.mail</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;&lt;/</span><span style="color:#116329;">i-input</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">      &lt;/</span><span style="color:#116329;">i-form-item</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;/</span><span style="color:#116329;">i-form</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">button</span><span style="color:#24292F;"> @</span><span style="color:#0550AE;">click</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">handleSubmit</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;提交&lt;/</span><span style="color:#116329;">button</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">    &lt;</span><span style="color:#116329;">button</span><span style="color:#24292F;"> @</span><span style="color:#0550AE;">click</span><span style="color:#24292F;">=</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">handleReset</span><span style="color:#0A3069;">&quot;</span><span style="color:#24292F;">&gt;重置&lt;/</span><span style="color:#116329;">button</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">  &lt;/</span><span style="color:#116329;">div</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">template</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#24292F;">&lt;</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> iForm </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;../components/form/form.vue&quot;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> iFormItem </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;../components/form/form-item.vue&quot;</span></span>
<span class="line"><span style="color:#CF222E;">import</span><span style="color:#24292F;"> iInput </span><span style="color:#CF222E;">from</span><span style="color:#24292F;"> </span><span style="color:#0A3069;">&quot;../components/input/input.vue&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CF222E;">export</span><span style="color:#953800;"> </span><span style="color:#CF222E;">default</span><span style="color:#953800;"> {</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">components: { iForm, iFormItem, iInput }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#8250DF;">data</span><span style="color:#953800;">() </span><span style="color:#24292F;">{</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#CF222E;">return</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">      formValidate: {</span></span>
<span class="line"><span style="color:#24292F;">        name: </span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">        mail: </span><span style="color:#0A3069;">&quot;&quot;</span><span style="color:#24292F;">,</span></span>
<span class="line"><span style="color:#24292F;">      },</span></span>
<span class="line"><span style="color:#24292F;">      ruleValidate: {</span></span>
<span class="line"><span style="color:#24292F;">        name: [{ required: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">, message: </span><span style="color:#0A3069;">&quot;用户名不能为空&quot;</span><span style="color:#24292F;">, trigger: </span><span style="color:#0A3069;">&quot;blur&quot;</span><span style="color:#24292F;"> }],</span></span>
<span class="line"><span style="color:#24292F;">        mail: [</span></span>
<span class="line"><span style="color:#24292F;">          { required: </span><span style="color:#0550AE;">true</span><span style="color:#24292F;">, message: </span><span style="color:#0A3069;">&quot;邮箱不能为空&quot;</span><span style="color:#24292F;">, trigger: </span><span style="color:#0A3069;">&quot;blur&quot;</span><span style="color:#24292F;"> },</span></span>
<span class="line"><span style="color:#24292F;">          { type: </span><span style="color:#0A3069;">&quot;email&quot;</span><span style="color:#24292F;">, message: </span><span style="color:#0A3069;">&quot;邮箱格式不正确&quot;</span><span style="color:#24292F;">, trigger: </span><span style="color:#0A3069;">&quot;blur&quot;</span><span style="color:#24292F;"> },</span></span>
<span class="line"><span style="color:#24292F;">        ],</span></span>
<span class="line"><span style="color:#24292F;">      },</span></span>
<span class="line"><span style="color:#24292F;">    }</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">  </span><span style="color:#24292F;">methods: {</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">handleSubmit</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.$refs.form.</span><span style="color:#8250DF;">validate</span><span style="color:#24292F;">((</span><span style="color:#953800;">valid</span><span style="color:#24292F;">) </span><span style="color:#CF222E;">=&gt;</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">        </span><span style="color:#CF222E;">if</span><span style="color:#24292F;"> (valid) {</span></span>
<span class="line"><span style="color:#24292F;">          window.</span><span style="color:#8250DF;">alert</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;提交成功&quot;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">        } </span><span style="color:#CF222E;">else</span><span style="color:#24292F;"> {</span></span>
<span class="line"><span style="color:#24292F;">          window.</span><span style="color:#8250DF;">alert</span><span style="color:#24292F;">(</span><span style="color:#0A3069;">&quot;表单校验失败&quot;</span><span style="color:#24292F;">)</span></span>
<span class="line"><span style="color:#24292F;">        }</span></span>
<span class="line"><span style="color:#24292F;">      })</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">    </span><span style="color:#8250DF;">handleReset</span><span style="color:#24292F;">() {</span></span>
<span class="line"><span style="color:#24292F;">      </span><span style="color:#0550AE;">this</span><span style="color:#24292F;">.$refs.form.</span><span style="color:#8250DF;">resetFields</span><span style="color:#24292F;">()</span></span>
<span class="line"><span style="color:#24292F;">    },</span></span>
<span class="line"><span style="color:#24292F;">  }</span><span style="color:#953800;">,</span></span>
<span class="line"><span style="color:#953800;">}</span></span>
<span class="line"><span style="color:#24292F;">&lt;/</span><span style="color:#116329;">script</span><span style="color:#24292F;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">总结</p><p>通过对前端组件的分析，需要重点关注组件中易变性对组件封装的影响，它会对组件的可复用性、可扩展性产生很大影响</p></div></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: zhoubichuan@icloud.com">周必川</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/web-vue3/senior/4.component/2.dropdown.html" class="" aria-label="一.命令输入（下拉菜单）"><!--[--><!--]--> 一.命令输入（下拉菜单） <!--[--><!--]--></a></span><span class="next"><a href="/web-vue3/senior/4.component/4.input.html" class="" aria-label="二.数据输入（输入框）"><!--[--><!--]--> 二.数据输入（输入框） <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/web-vue3/assets/app.8390b8a1.js" defer></script>
  </body>
</html>
